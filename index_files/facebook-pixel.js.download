var rootlinkFBPixel="https://apps.omegatheme.com/facebook-pixel",rootLinkFBPixelLog="https://fbpixeleventlog.omegatheme.com/api/";function otTransformURL(t){var e=t.split("?")[1];return void 0!==e?-1!==e.indexOf("&")?(e=e.slice(e.indexOf("&")+1,e.length),t.split("?")[0]+"?"+e):t.split("?")[0]:t}function otConvertShopName(){return null!=localStorage.getItem("ot_fb_shop")?localStorage.getItem("ot_fb_shop"):""}function otConvertPageUrl(){var t=window.location.href,e=t.indexOf("/wpm@"),o=t.indexOf("/sandbox")+"/sandbox".length,e=t.slice(e,o);return t.replace(e,"")}function otIsJsonString(t){try{JSON.parse(t)}catch(t){return!1}return!0}function otSetCookie(t,e,o){var n=new Date,o=(n.setTime(n.getTime()+24*o*60*60*1e3),"expires="+n.toGMTString());document.cookie=t+"="+e+";"+o+";path=/"}function otGetCookie(t){var o=t+"=",n=(document.cookie,document.cookie.split(";"));for(let e=0;e<n.length;e++){let t=n[e];for(;" "==t.charAt(0);)t=t.substring(1);if(0==t.indexOf(o))return t.substring(o.length,t.length)}return""}function otDeleteCookie(t,e,o){""!=otGetCookie(t)&&(document.cookie=t+"="+(e?";path="+e:"")+(o?";domain="+o:"")+";expires=Thu, 01 Jan 1970 00:00:01 GMT")}function generateEventID(t){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".split(""),o=[],n=0;n<t;n++){var a=(Math.random()*(e.length-1)).toFixed(0);o[n]=e[a]}return o.join("")}function ot_getUrlParam(t){t=window.location.search.match("[?&]"+t+"(?:&|$|=([^&]*))");return t?t[1]||"":null}function getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t)+t)}async function sha256(t){t=(new TextEncoder).encode(t),t=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(t)).map(t=>t.toString(16).padStart(2,"0")).join("")}function otTrackEventConversionAPI(t,e){fetch(t,{method:"POST",body:e}).then(function(t){}).catch(function(t){console.log(t)})}function otSaveAdvancedMatchings(t){var e=null!=t.email?t.email:"",o=null!=t.shippingAddress.city?t.shippingAddress.city.toLowerCase():"",n=null!=t.shippingAddress.phone?t.shippingAddress.phone:"",a=null!=t.shippingAddress.zip?t.shippingAddress.zip:"",i=null!=t.shippingAddress.firstName?t.shippingAddress.firstName.toLowerCase():"",r=null!=t.shippingAddress.lastName?t.shippingAddress.lastName.toLowerCase():"",c=null!=t.shippingAddress.countryCode?t.shippingAddress.countryCode.toLowerCase():"",t=null!=t.shippingAddress.provinceCode?t.shippingAddress.provinceCode.toLowerCase():"",s={em:e,ct:o,ph:n,zp:a,fn:i,ln:r,external_id:externalID,country:c,st:t},c=Object.keys(s);if(0<c.length)for(const _ of c)""==s[_]&&delete s[_];window.localStorage.setItem("OT_DATA_CUSTOMER__TRACK_FB",JSON.stringify(s)),OT_DATA_CUSTOMER__TRACK_FB=s,window.localStorage.setItem("OT_DATA_CUSTOMER",JSON.stringify({em:e,ct:o,ph:n,zp:a,first_name:i,last_name:r,external_id:externalID}))}function otGetContentCategories(t){let o=[];return t.forEach(function(t,e){o.push(t.variant.product.type)}),(o=[...new Set(o)]).filter(t=>""!==t).toString()}function removeElementInObject(t,e){var o=Object.keys(t);if(0<o.length)for(const n of o)t[n]==e&&delete t[n];return t}function otGetAttributeFBCAndFBP(){var t=(new Date).getTime()+getRandomInt(1,1e5),e=(new Date).getTime();return{fbc:otDetectFbc("1",e),fbp:otDetectFbp("1",e,t)}}function otDetectFbc(t,e){var o=otGetCookie("OT_FBCLID"),n=ot_getUrlParam("fbclid");return null!=n?(otSetCookie("OT_FBCLID",t=`fb.${t}.${e}.`+n,14),t):""!=o?o:null}function otFBDetectExternalID(){var t=otGetCookie("c_user"),e=otGetCookie("ex_id");return null!=t&&""!==t?(otSetCookie("ex_id",e,14),t):(null!=e&&""!==e||otSetCookie("ex_id",e=generateEventID(10),14),e)}function otDetectFbp(t,e,o){var n=otGetCookie("OT_FBPLID"),a=otGetCookie("_fbp");return""!==a?a:""!==n?n:(otSetCookie("OT_FBPLID",a=`fb.${t}.${e}.`+o,14),a)}function otAddUtmField(t,e=!1){var o=ot_getUrlParam(t),t=t.replace("omega_",""),e=(e&&otDeleteCookie("ot_fb_"+t),ot_getUrlParam(t));if(null!==e||null!==o){if("utm_campaign"==t&&(document.cookie="ot_fb_ad_name= ;  expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie="ot_fb_adset_name= ;  expires=Thu, 01 Jan 1970 00:00:01 GMT"),null!==o)return otSetCookie("ot_fb_"+t,o,14),{status:"success",data:""!=o?o:"undetectable"};if(null!==e)return otSetCookie("ot_fb_"+t,e,14),{status:"success",data:""!=e?e:"undetectable"}}else if(""!==otGetCookie("ot_fb_"+t))return{status:"success",data:otGetCookie("ot_fb_"+t)};return{status:"false",data:null}}function OtDetectAdsUrl(){let e=!1;return["fbclid","omega_utm_campaign","omega_ad_name","omega_adset_name","omega_utm_source","utm_campaign","ad_name","utm_source","adset_name"].every(t=>!window.location.search.includes(t)||!(e=!0)),e}function otFBDetectCampaign(){var t=OtDetectAdsUrl(),e={},o=otAddUtmField("omega_utm_campaign",t),n=otAddUtmField("omega_ad_name",t),a=otAddUtmField("omega_adset_name",t),t=otAddUtmField("omega_utm_source",t);return e.utm_campaign="success"==o.status?o.data:"undetectable",e.ad_name="success"==n.status?n.data:"undetectable",e.adset_name="success"==a.status?a.data:"undetectable",e.utm_source="success"==t.status&&"facebook"==t.data?"Facebook":"Other",e}function otGetContentProduct(t){return t.map(t=>({id:1,name:"",quantity:""}))}var itemInCart,ot_fb_shop=Shopify.shop,fb_pageURL=(localStorage.setItem("ot_fb_shop",ot_fb_shop),window.location.href),ot_information_campaign=("undefined"!=typeof __st&&void 0!==__st.pageurl&&(fb_pageURL="https://"+__st.pageurl),"undefined"!=typeof arrayFBPixelTrack&&localStorage.setItem("ot_omega_px",arrayFBPixelTrack),fb_pageURL=otTransformURL(fb_pageURL),otFBDetectCampaign()),externalID=otFBDetectExternalID(),obj_fbp_fbc=otGetAttributeFBCAndFBP(),OT_DATA_CUSTOMER={},OT_DATA_CUSTOMER__TRACK_FB=(null!==localStorage.getItem("OT_DATA_CUSTOMER")&&otIsJsonString(localStorage.getItem("OT_DATA_CUSTOMER"))&&(OT_DATA_CUSTOMER=JSON.parse(localStorage.getItem("OT_DATA_CUSTOMER"))),{external_id:externalID}),otListAllCustomEvents=(null!==localStorage.getItem("OT_DATA_CUSTOMER__TRACK_FB")&&otIsJsonString(localStorage.getItem("OT_DATA_CUSTOMER__TRACK_FB"))&&(OT_DATA_CUSTOMER__TRACK_FB=JSON.parse(localStorage.getItem("OT_DATA_CUSTOMER__TRACK_FB"))),[]),otListAllCustomAddToCart=[],otListAllCustomCheckout=[],otListAllCustomLead=[],isCustomEventPage=ot_getUrlParam("otCustomEvent"),conditionIncludeFileEventSetup=sessionStorage.getItem("OT_FACEBOOK_EVENT_SETUP"),currency=Shopify.currency.active,cart_url="//"+window.location.hostname+"/cart.json",otFBElementButtonAddToCart=".product-form__add-button, .product-form__add-button .loader-button__loader,[data-add-to-cart-text],.ProductForm__AddToCart,#teeAtcButton,#new-form-atc,.single_add_to_cart_button,#AddToCartForm button,.product__form button.add-to-cart, #AddToCart-product-template,.product-form__cart-submit,[name^='add']",otFBElementButtonCheckout='.bettercart_checkout,[name^="checkout"],[name^="checkout"] .loader-button__text,.shopify-payment-button__button,.btn-checkout,a.fbq-checkout,.checkout_btn,.OTCheckout,.OTCheckout span,#cart .action_button.right';if(!function(_,l){_.otfbq||(_.otfbq=async function(){if(otLogNameBaseCode("Omega"),0<arguments.length){"string"==typeof arguments[0]&&(r=arguments[0]),"string"==typeof arguments[1]&&(t=arguments[1]),"object"==typeof arguments[2]&&(e=arguments[2]),void 0!==arguments[3]&&(o=arguments[3]),void 0!==arguments[4]&&(nameCustomEvent=arguments[4]),""!=o&&void 0!==o||(o=(new Date).getTime()+getRandomInt(1,1e5));var t,e,o,n=[];if("string"==typeof r&&""!=r.replace(/\s+/gi,"")&&"string"==typeof t&&t.replace(/\s+/gi,"")){switch(n.push("id="+encodeURIComponent(r)),t){case"PageView":case"ViewContent":case"Search":case"AddToCart":case"InitiateCheckout":case"AddPaymentInfo":case"Lead":case"CompleteRegistration":case"Purchase":case"AddToWishlist":n.push("ev="+encodeURIComponent(t));break;case"trackCustom":n.push("ev="+encodeURIComponent(nameCustomEvent));break;default:return}if(n.push("dl="+encodeURIComponent(fb_pageURL)),l.referrer&&n.push("rl="+encodeURIComponent(l.referrer)),n.push("if=false"),n.push("ts="+(new Date).getTime()),"object"==typeof e)for(var a in e)if("object"==typeof e[a]&&e[a]instanceof Array){if(0<e[a].length){for(var i=0;i<e[a].length;i++)e[a][i]=(e[a][i]+"").replace(/^\s+|\s+$/gi,"").replace(/\s+/gi," ").replace(/,/gi,"ยง");n.push("cd["+a+"]="+encodeURIComponent(e[a].join(",").replace(/^/gi,"['").replace(/$/gi,"']").replace(/,/gi,"','").replace(/ยง/gi,",")))}}else n.push("cd["+a+"]="+encodeURIComponent(e[a]));var r=Object.keys(OT_DATA_CUSTOMER__TRACK_FB);if(0<r.length)for(const s of r)n.push("&ud["+s+"]="+await sha256(OT_DATA_CUSTOMER__TRACK_FB[s]));n.push("v="+encodeURIComponent("2.7.19"));var c=(new Date).getTime(),r=l.createElement("img");r.id="fb_"+c,r.src="https://www.facebook.com/tr/?eid="+o+"&"+n.join("&"),r.width=1,r.height=1,r.style="display:none;",l.body.appendChild(r),_.setTimeout(function(){var t=l.getElementById("fb_"+c);t.parentElement.removeChild(t)},5e3)}}})}(window,document),!function(t,e,o,n,a){t.fbq||(o=t.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},t._fbq||(t._fbq=o),(o.push=o).loaded=!0,o.version="2.0",o.queue=[],(n=e.createElement("script")).async=!0,n.src="https://connect.facebook.net/en_US/fbevents.js",(a=e.getElementsByTagName("script")[0]).parentNode.insertBefore(n,a))}(window,document),window.otBaseCodeFB=function(){var t,e,o,n;if((otLogNameBaseCode("FB"),0<arguments.length)&&("string"==typeof arguments[0]&&(t=arguments[0]),"string"==typeof arguments[1]&&(e=arguments[1]),"object"==typeof arguments[2]&&(o=arguments[2]),void 0!==arguments[3]&&(n=arguments[3]),void 0!==arguments[4]&&(nameCustomEvent=arguments[4]),""!=n&&void 0!==n||(n=(new Date).getTime()+getRandomInt(1,1e5)),"string"==typeof t&&""!=t.replace(/\s+/gi,"")&&"string"==typeof e&&e.replace(/\s+/gi,"")))switch(fbq("init",t,OT_DATA_CUSTOMER__TRACK_FB),e){case"PageView":fbq("trackSingle",t,"PageView",{},{eventID:n});break;case"ViewContent":case"Search":case"AddToCart":case"InitiateCheckout":case"AddPaymentInfo":case"Lead":case"CompleteRegistration":case"Purchase":case"AddToWishlist":fbq("trackSingle",t,e,o,{eventID:n});break;case"trackCustom":fbq("trackSingle",t,nameCustomEvent,o,{eventID:n});break;default:return}},window.addEventListener("message",async t=>{var e;"ot_omega_get"==t.data?(e=document.querySelectorAll('#WebPixelsManagerSandboxContainer [sandbox="allow-scripts allow-forms"]'),"undefined"!=typeof arrayFBPixelTrack&&0<e.length&&e.forEach(t=>{t.contentWindow.postMessage("ot_omega_px:"+arrayFBPixelTrack,"*"),t.contentWindow.postMessage("ot_omega_settings:"+JSON.stringify(omegaFBSettings),"*")})):"string"==typeof t.data&&t.data.includes("ot_track_add_to_cart")&&omegaCallBackAddToCartTrigger(JSON.parse(t.data.slice(21)))}),"undefined"==typeof $)!function(t){t.src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js",t.onload=function(){$=jQuery.noConflict(),includeSetUpEventPage((new Date).getTime(),conditionIncludeFileEventSetup,isCustomEventPage),void 0===window.otFbPixelCheckExistFile&&(otFacebookPixelInit($),window.otFbPixelCheckExistFile=!1)},document.head.appendChild(t)}(document.createElement("script"));else{let t=(new Date).getTime();includeSetUpEventPage(t,conditionIncludeFileEventSetup,isCustomEventPage),void 0===window.otFbPixelCheckExistFile&&(otFacebookPixelInit($),window.otFbPixelCheckExistFile=!1)}if("undefined"!=typeof omegaFBSettings&&(omegaFBSettings.settings.is_enable_trigger,1)){let t=document.querySelectorAll('#WebPixelsManagerSandboxContainer [sandbox="allow-scripts allow-forms"]');"undefined"!=typeof arrayFBPixelTrack&&0<t.length&&t.forEach(t=>{t.contentWindow.postMessage("ot_omega_px:"+arrayFBPixelTrack,"*"),t.contentWindow.postMessage("ot_omega_settings:"+JSON.stringify(omegaFBSettings),"*")})}function otDisagreeForTracking(){var t;return"digital-army.myshopify.com"===Shopify.shop&&(t="true"!==otGetCookie("otAcceptMarketing")||"yes"!==window?.Shopify?.customerPrivacy?.getTrackingConsent(),console.log("%c Omega Facebook pixels - Disagree For Tracking: "+t,"color: red; background: white;padding: 5px; border-radius: 5px"),t)}async function otFacebookPixelInit(t){if(otDisagreeForTracking())return!0;var e=[],o="undefined"!=typeof omegaFBSettings,n=(e=o?omegaFBSettings:await otFacebookPixelCheckExpireApp(t,rootlinkFBPixel,ot_fb_shop)).settings;otFBAddAttributeClickIdToOrder(t,n),e.list_all_custom_events.forEach(t=>{0==t.event_type&&otListAllCustomEvents.push(t),1==t.event_type&&otListAllCustomLead.push(t),2==t.event_type&&otListAllCustomAddToCart.push(t),3==t.event_type&&otListAllCustomCheckout.push(t)}),o?"1"==omegaFBSettings.settings.enable&&otMultiFacebookPixel(t,n):"1"==e.enableApp&&otMultiFacebookPixel(t,n)}async function otMultiFacebookPixel(r,c){let s="1"==c.content_type_event?"product":"product_group";if("1"==c.use_basecode_fb&&(window.otfbq=window.otBaseCodeFB),"undefined"!=typeof arrayFBPixelTrack&&0<arrayFBPixelTrack.length&&"0"==omegaFBSettings.settings.is_enable_trigger){detectCustomEvents(arrayFBPixelTrack,otListAllCustomEvents),detectLeadEvents(arrayFBPixelTrack,otListAllCustomLead);let o=generateEventID(36);if("1"==c.capi_track_pageview&&-1==fb_pageURL.indexOf("/products/")&&(arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"PageView","",o)}),trackEventFBConversionAPI(r,{action:"PageView",event_id:o,event_source_url:fb_pageURL,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})),-1<fb_pageURL.indexOf("/products/")){var i=await otGetInfoProductByLink(-1<fb_pageURL.indexOf("?")?fb_pageURL.split("?")[0]+".json":fb_pageURL+".json",r);-1<i.title.indexOf("'")&&(i.title=i.title.replace(/'/g,""));let o=generateEventID(36),e=(arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"PageView","",o)}),ot_getUrlParam("variant")),n=null!==e?e:meta.product.variants[0].id,a=("product_group"==s&&(n=(void 0!==i.id?i:meta.product).id),i.variants[0].price);null!=e&&meta.product.variants.forEach(t=>{t.id==e&&(a=parseInt(t.price)/100)}),arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"ViewContent",{content_ids:[n],content_type:s,value:a,content_name:i.title,currency:Shopify.currency.active},o)}),"1"==c.capi_track_viewcontent&&trackEventFBConversionAPI(r,{action:"ViewContent",event_id:o,event_source_url:fb_pageURL,content_ids:[n],content_type:s,value:a,content_name:i.title,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}if(-1<fb_pageURL.indexOf("/search")){let o=generateEventID(36);arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"Search","",o)}),null!=document.querySelector('meta[property="og:url"]')?document.querySelector('meta[property="og:url"]').getAttribute("content"):window.location.href,"1"==c.capi_track_search&&trackEventFBConversionAPI(r,{action:"Search",event_id:o,event_source_url:fb_pageURL,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}-1<fb_pageURL.indexOf("/cart")&&getItemOnCartPageFB(r,function(a){var t=(itemInCart=a).items;let i=t[t.length-1];var t=localStorage.getItem("OTPX"),e=localStorage.getItem("OTPXADDED");if((t!=a.item_count||null==t)&&1!=e){localStorage.setItem("OTPXADDED",0),localStorage.setItem("OTPX",a.item_count);let o=i.variant_id,n=("product_group"==s&&(o=i.product_id),generateEventID(36));arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"AddToCart",{content_ids:o,content_type:s,value:parseInt(a.total_price)/100,content_name:i.product_title,currency:Shopify.currency.active},n)}),"1"==c.capi_track_addtocart&&trackEventFBConversionAPI(r,{action:"AddToCart",event_id:n,event_source_url:fb_pageURL,content_ids:o,content_type:s,value:parseInt(a.total_price)/100,content_name:i.product_title,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}}),document.addEventListener("click",function(t){otEventClickIsMatchesDom(t,otFBElementButtonAddToCart,otListAllCustomAddToCart)&&setTimeout(()=>{getItemOnCartPageFB(r,function(t){otTrackATC(arrayFBPixelTrack,c,t,s)})},500),otEventClickIsMatchesDom(t,otFBElementButtonCheckout,otListAllCustomCheckout)&&getItemOnCartPageFB(r,function(t){otTrackIC(arrayFBPixelTrack,c,t,s)})})}else-1<fb_pageURL.indexOf("/products/")?omegaCallBackViewContent():-1<fb_pageURL.indexOf("/cart")&&null!=localStorage.getItem("OT_DATA_TRIGGER_ATC")&&omegaCallBackAddToCartTrigger(JSON.parse(localStorage.getItem("OT_DATA_TRIGGER_ATC")));handleCheckPageIsThankYouPage(c,s,Shopify),void 0!==Shopify.Checkout&&void 0!==Shopify.Checkout.isOrderStatusPage&&trackOrderStatusPage(r)}function otTrackIC(r,c,t,s){if(void 0!==t&&void 0!==t.items){var i=t;if(0<i.items.length){let n=[],a=[];$.each(i.items,function(t,e){if("product_group"==s?n.push(e.product_id):n.push(e.variant_id),a.push(e.product_title),t==i.items.length-1){let o=generateEventID(36);r.forEach(function(t,e){otfbq(""+t,"InitiateCheckout",{content_type:s,content_ids:n,currency:Shopify.currency.active,value:parseFloat(i.total_price)/100,num_items:i.item_count,content_name:a},o)}),"1"==c.capi_track_checkout&&trackEventFBConversionAPI($,{action:"InitiateCheckout",event_id:o,event_source_url:fb_pageURL,content_ids:n,content_type:s,num_items:i.item_count,value:parseFloat(i.total_price)/100,content_name:a,currency:Shopify.currency.active,pixels:r,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}})}}else $.ajax({type:"GET",url:"/cart.js",dataType:"json"}).done(i=>{if(0<i.items.length){let n=[],a=[];$.each(i.items,function(t,e){if("product_group"==s?n.push(e.product_id):n.push(e.variant_id),a.push(e.product_title),t==i.items.length-1){let o=generateEventID(36);r.forEach(function(t,e){otfbq(""+t,"InitiateCheckout",{content_type:s,content_ids:n,currency:Shopify.currency.active,value:parseFloat(i.total_price)/100,num_items:i.item_count,content_name:a},o)}),"1"==c.capi_track_checkout&&trackEventFBConversionAPI($,{action:"InitiateCheckout",event_id:o,event_source_url:fb_pageURL,content_ids:n,content_type:s,num_items:i.item_count,value:parseFloat(i.total_price)/100,content_name:meta.product.variants[0].name,currency:Shopify.currency.active,pixels:r,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}})}else{let o=generateEventID(36);r.forEach(function(t,e){otfbq(""+t,"InitiateCheckout",{},o)})}}).fail(function(t,e){let o=generateEventID(36);r.forEach(function(t,e){otfbq(""+t,"InitiateCheckout",{},o)})})}async function trackOrderStatusPage(t){var t=await otGetAllPixel(t),o=generateEventID(36);0<t.length&&t.forEach(function(t,e){otfbq(""+t,"PageView","",o)})}function ABTestOtGetAllPixel(t,o){return new Promise(t=>{var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&t(JSON.parse(e.responseText))},e.open("GET",rootlinkFBPixel+`/client/facebook-pixel.php?shop=${ot_fb_shop}&action=ABTestOtGetAllPixel&productIDs=`+o,!0),e.send()})}function getItemOnCartPageFB(t,e){t.ajax({type:"GET",url:"/cart.js",dataType:"json"}).done(t=>{"function"==typeof e&&e(t)})}function otFacebookPixelCheckExpireApp(t,o,n){"use strict";return new Promise(e=>{t.ajax({type:"GET",data:{action:"checkExpire",shop:n},url:o+"/client/facebook-pixel.php",dataType:"json"}).done(t=>{"string"==typeof t&&(t=JSON.parse(t)),e(t)})})}function otSaveUrlToMongo(n,a,i){"use strict";otGetIP().then(t=>{let o=t.split("ip=")[1].split("\n")[0];return new Promise(e=>{n.ajax({type:"POST",data:{url:a,shop:i,ip:o,user_agent:window.navigator.userAgent},url:rootLinkFBPixelLog+"url-logs",dataType:"json"}).done(t=>{"string"==typeof t&&(t=JSON.parse(t)),e(t)})})})}function otGetIP(){return fetch("https://www.cloudflare.com/cdn-cgi/trace").then(t=>t.text())}function handleCheckPageIsThankYouPage(n,t,e){var a,i,r,c;e.Checkout&&e.Checkout.page&&-1<e.Checkout.page.indexOf("thank_you")&&(handleAddEventMatching(n),null==localStorage.getItem("otfb_"+e.checkout.order_id))&&(a=[],i=[],r=[],c=0,e.checkout.line_items.forEach(function(t,e){var o;c+=t.quantity,o=""!=t.variant_title?t.title+" - "+t.variant_title:t.title,a.push(t.product_id),r.push(o),"1"==n.content_type_event?i.push(t.variant_id):i.push(t.product_id)}),addEventPurchaseInThankYouPage($,a,i,c,n,t))}async function addEventPurchaseInThankYouPage(t,o,n,a,i,r){let c=Shopify.checkout;localStorage.setItem("otfb_"+c.order_id,c.order_id);var s,o=await ABTestOtGetAllPixel(t,o);let _=[];if(0<o.length&&o.forEach(t=>{_.push(t.pixel_id)}),0<o.length){s=1==i.include_shippping_cost?c.total_price:c.subtotal_price;let e=generateEventID(36);o.forEach(function(t){otfbq(""+t.pixel_id,"PageView","",e),otfbq(""+t.pixel_id,"Purchase",{currency:Shopify.currency.active,value:s,content_ids:n,content_type:r,num_items:a},c.order_id)}),localStorage.setItem("item_count",0),"1"==i.capi_track_pageview&&0<_.length&&-1==fb_pageURL.indexOf("/products/")&&trackEventFBConversionAPI(t,{action:"PageView",event_id:e,event_source_url:fb_pageURL,pixels:_,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}}function getFbClientId(){var t=/_fbp=(fb\.1\.\d+\.\d+)/.exec(window.document.cookie);return t&&t[1]?t[1]:null}function otGetAllPixel(t){return new Promise(t=>{var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&t(JSON.parse(e.responseText))},e.open("GET",rootlinkFBPixel+`/client/facebook-pixel.php?shop=${ot_fb_shop}&action=getAllPixel`,!0),e.send()})}function otGetInfoProductByLink(t,o){return new Promise(e=>{o.ajax({url:t,dataType:"jsonp",header:{"Access-Control-Allow-Origin":"*"},success:function(t){"string"==typeof t&&(t=JSON.parse(t)),e(t.product)}})})}function trackEventFBConversionAPI(t,e){t.ajax({url:rootlinkFBPixel+"/client/facebook-conversion-api.php",type:"POST",dataType:"json",data:{...e,external_id:externalID}}).done(t=>{}).fail(t=>{console.log(t)})}function detectShopifyPixel(){t=void 0!==trekkie.integrations&&void 0!==trekkie.integrations[1]?trekkie.integrations[1].options.pixelIds:"";var t,e=new XMLHttpRequest;e.open("GET",rootlinkFBPixel+`/client/facebook-pixel.php?shop=${ot_fb_shop}&action=saveShopifyPixel&ShopifyPixelID=`+t,!0),e.send()}function trackEventTimeOnPage(n,e){if("1"==e.isTimeOnPage){let t=1e3*parseInt(e.intervalTrackTimeOnPage),o=t;setInterval(()=>{let e=(new Date).getTime()+getRandomInt(1,1e5)+o;n.forEach(function(t){window.otfbq(""+t,"trackCustom",{time:o},e,"TimeOnPage")}),trackEventFBConversionAPI($,{action:"TimeOnPage",event_id:e,event_source_url:fb_pageURL,pixels:n,shop:Shopify.shop,timeOnPage:o,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign}),o+=t},t)}}function detectCustomEvents(o,t){0<t.length&&t.forEach(function(e){document.addEventListener("click",function(t){""!==e.button_fires_by_class_id&&t.target.textContent.match(e.button_fires_by_text)&&t.target.matches(e.button_fires_by_class_id)?(console.log("match class,id: "+e.button_fires_by_class_id+" and text: "+e.button_fires_by_text),trackCustomEvent(o,e.event_name)):""==e.button_fires_by_class_id&&0==t.target?.classList?.length&&t.target.textContent.match(e.button_fires_by_text)&&(console.log("match text: "+e.button_fires_by_text),trackCustomEvent(o,e.event_name))})})}function detectLeadEvents(o,t){0<t.length&&t.forEach(function(e){document.addEventListener("click",function(t){""!==e.button_fires_by_class_id&&t.target.textContent.match(e.button_fires_by_text)&&t.target.matches(e.button_fires_by_class_id)?(console.log("match class,id: "+e.button_fires_by_class_id+" and text: "+e.button_fires_by_text),trackLeadEvent(o)):""==e.button_fires_by_class_id&&0==t.target?.classList?.length&&t.target.textContent.match(e.button_fires_by_text)&&(console.log("match text: "+e.button_fires_by_text),trackLeadEvent(o))})})}function trackLeadEvent(t){let e=(new Date).getTime()+getRandomInt(1,1e5);t.forEach(function(t){otfbq(""+t,"Lead","",e)}),trackEventFBConversionAPI($,{action:"Custom",event_name:"Lead",event_id:e,event_source_url:fb_pageURL,pixels:t,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}function trackCustomEvent(t,e){let o=(new Date).getTime()+getRandomInt(1,1e5);t.forEach(function(t){window.otfbq(""+t,"trackCustom","",o,e)}),trackEventFBConversionAPI($,{action:"Custom",event_name:e,event_id:o,event_source_url:fb_pageURL,pixels:t,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}function otTrackATC(t,e,a,i){var r=a,a=(localStorage.setItem("OTPXADDED",1),+localStorage.getItem("item_count"));if(a!=r.item_count)if(0<r.items.length){window.localStorage.setItem("item_count",r.item_count);let o=r.items[0],n=generateEventID(36),a=o.variant_id;"product_group"==i&&(a=o.product_id),t.forEach(function(t,e){otfbq(""+t,"AddToCart",{content_ids:a,content_type:i,value:parseInt(r.total_price)/100,content_name:o.product_title,currency:Shopify.currency.active},n)}),"1"==e.capi_track_addtocart&&trackEventFBConversionAPI($,{action:"AddToCart",event_id:n,event_source_url:fb_pageURL,content_ids:a,content_type:i,value:parseInt(r.total_price)/100,content_name:o.product_title,currency:Shopify.currency.active,pixels:t,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}else if(void 0!==meta.product){a=ot_getUrlParam("variant");let o=null!==a?a:meta.product.variants[0].id,n=("product_group"==i&&(o=meta.product.id),generateEventID(36));t.forEach(function(t,e){otfbq(""+t,"AddToCart",{content_ids:o,content_type:i,value:parseInt(meta.product.variants[0].price)/100,content_name:meta.product.variants[0].name,currency:Shopify.currency.active},n)}),"1"==e.capi_track_addtocart&&trackEventFBConversionAPI($,{action:"AddToCart",event_id:n,event_source_url:fb_pageURL,content_ids:o,content_type:i,value:parseInt(meta.product.variants[0].price)/100,content_name:meta.product.variants[0].name,currency:Shopify.currency.active,pixels:t,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}else{let o=generateEventID(36);t.forEach(function(t,e){otfbq(""+t,"AddToCart",{},o)})}else 0==r.item_count&&setTimeout(()=>{omegaCallBackAddToCart()},1e3)}function includeSetUpEventPage(t,e,o){"show"!=e&&"1"!=o||(sessionStorage.setItem("OT_FACEBOOK_EVENT_SETUP","show"),$.getScript(rootlinkFBPixel+"/client/customEvent.js?v="+t))}function otEventClickIsMatchesDom(e,t,o){var n=!1;return!!e.target.matches(t)||(o.forEach(t=>{""!==t.button_fires_by_class_id&&e.target.textContent.match(t.button_fires_by_text)&&e.target.matches(t.button_fires_by_class_id)?(console.log("match class,id: "+t.button_fires_by_class_id+" and text: "+t.button_fires_by_text),n=!0):""==t.button_fires_by_class_id&&0==e.target?.classList?.length&&e.target.textContent.match(t.button_fires_by_text)&&(console.log("match text: "+t.button_fires_by_text),n=!0)}),n)}function otLogNameBaseCode(t){void 0===window.otLogInformationCode&&(console.log(`%c Omega Facebook pixels: Event tracking using the ${t} codebase`,"color: white; background: #9500ff;padding: 5px; border-radius: 5px"),window.otLogInformationCode=!1)}function otFBAddAttributeClickIdToOrder(t,e){1==e.accept_permission_fb_ads&&1==e.capi_track_purchase&&(ot_fbc_fbp=otGetAttributeFBCAndFBP(),t.ajax({type:"POST",url:"/cart/update.js",dataType:"json",data:{attributes:{ot_fbc_fbp:JSON.stringify(ot_fbc_fbp),obj_campaign:JSON.stringify(ot_information_campaign),external_id:externalID}}}).done(t=>{console.log("Add ttclid: "+JSON.stringify(ot_fbc_fbp))}))}async function omegaCallBackViewContent(){var t=("undefined"!=typeof omegaFBSettings?omegaFBSettings:await otFacebookPixelCheckExpireApp($,rootlinkFBPixel,ot_fb_shop)).settings,e="1"==t.content_type_event?"product":"product_group",o=await otGetInfoProductByLink(-1<fb_pageURL.indexOf("?")?fb_pageURL.split("?")[0]+".json":fb_pageURL+".json",$);-1<o.title.indexOf("'")&&(o.title=o.title.replace(/'/g,""));let n=generateEventID(36),a=ot_getUrlParam("variant"),i=null!==a?a:meta.product.variants[0].id,r=("product_group"==e&&(i=(void 0!==o.id?o:meta.product).id),o.variants[0].price);null!=a&&meta.product.variants.forEach(t=>{t.id==a&&(r=parseInt(t.price)/100)});var c=JSON.stringify([{id:i,name:o.title,quantity:1,item_price:r,item_category:meta.product.type}]);let s={content_ids:[i],content_type:e,value:r,content_name:o.title,currency:Shopify.currency.active,content_category:o.product_type,content_brand:o.vendor,contents:c};arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"PageView","",n),otfbq(""+t,"ViewContent",s,n)}),"1"==t.capi_track_viewcontent&&trackEventFBConversionAPI($,{action:"ViewContent",...s,event_id:n,event_source_url:fb_pageURL,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}function omegaCallBackAddToCart(){$.ajax({type:"GET",url:"/cart.js",dataType:"json"}).done(a=>{var t=localStorage.getItem("item_count");if(localStorage.setItem("OTPXADDED",1),t!=a.item_count&&window.localStorage.setItem("item_count",a.item_count),t<a.item_count)if(0<a.items.length){let o=a.items[0],n=generateEventID(36);arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"AddToCart",{content_ids:o.variant_id,content_type:"product",value:parseInt(a.total_price)/100,content_name:o.product_title,currency:Shopify.currency.active},n)}),trackEventFBConversionAPI($,{action:"AddToCart",event_id:n,event_source_url:fb_pageURL,content_ids:o.variant_id,content_type:"product",value:parseInt(a.total_price)/100,content_name:o.product_title,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}else if(void 0!==meta.product){let o=ot_getUrlParam("variant"),n=generateEventID(36);arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"AddToCart",{content_ids:null!==o?o:meta.product.variants[0].id,content_type:"product",value:parseInt(meta.product.variants[0].price)/100,content_name:meta.product.variants[0].name,currency:Shopify.currency.active},n)}),trackEventFBConversionAPI($,{action:"AddToCart",event_id:n,event_source_url:fb_pageURL,content_ids:null!==o?o:meta.product.variants[0].id,content_type:"product",value:parseInt(meta.product.variants[0].price)/100,content_name:meta.product.variants[0].name,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}else{let o=generateEventID(36);arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"AddToCart",{},o)})}})}async function omegaCallBackAddToCartTrigger(a){let i="1"==("undefined"!=typeof omegaFBSettings?omegaFBSettings:await otFacebookPixelCheckExpireApp($,rootlinkFBPixel,ot_fb_shop)).settings.content_type_event?"product":"product_group";$.ajax({type:"GET",url:"/cart.json",dataType:"json"}).done(t=>{var e=localStorage.getItem("item_count");if(localStorage.setItem("OTPXADDED",1),window.localStorage.setItem("item_count",t.item_count),e!=t.item_count&&0<t.items.length){let o=generateEventID(36),t=a.data.cartLine.merchandise.id,n={content_ids:[t="product_group"==i?a.data.cartLine.merchandise.product.id:t],content_type:i,value:a.data.cartLine.merchandise.price.amount,content_name:a.data.cartLine.merchandise.product.title,currency:a.data.cartLine.merchandise.price.currencyCode,content_category:a.data.cartLine.merchandise.product.type,content_brand:a.data.cartLine.merchandise.product.vendor,contents:JSON.stringify([{id:t,name:a.data.cartLine.merchandise.product.title,quantity:1,item_price:a.data.cartLine.merchandise.price.amount,item_category:a.data.cartLine.merchandise.product.type}])};0<arrayFBPixelTrack.length&&(arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"AddToCart",n,o)}),trackEventFBConversionAPI($,{...n,action:"AddToCart",event_id:o,event_source_url:fb_pageURL,num_items:1,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})),localStorage.removeItem("OT_DATA_TRIGGER_ATC")}})}function handleAddEventMatching(t){if(Shopify.Checkout&&Shopify.Checkout.page&&-1<Shopify.Checkout.page.indexOf("thank_you")){var e=Shopify.checkout,o=void 0!==e.email?e.email:"",n=void 0!==e.phone&&null!=e.phone?e.phone:null!=e.shipping_address.phone&&void 0!==e.shipping_address.phone?e.shipping_address.phone:"",a=null!=e.shipping_address&&void 0!==e.shipping_address.city&&1==t.group_accept_information_customer.isCity?e.shipping_address.city:"",i=null!=e.shipping_address&&void 0!==e.shipping_address.zip&&1==t.group_accept_information_customer.isZipCode?e.shipping_address.zip:"",r=null!=e.shipping_address&&void 0!==e.shipping_address.country_code&&1==t.group_accept_information_customer.isCountry?e.shipping_address.country_code:"",c=null!=e.shipping_address&&void 0!==e.shipping_address.first_name&&1==t.group_accept_information_customer.isFirstName?e.shipping_address.first_name:"",t=null!=e.shipping_address&&void 0!==e.shipping_address.last_name&&1==t.group_accept_information_customer.isLastName?e.shipping_address.last_name:"",s={em:o,ct:a.toLowerCase(),ph:n,zp:i,fn:c.toLowerCase(),ln:t.toLowerCase(),external_id:externalID,country:r.toLowerCase()},e=Object.keys(s);if(0<e.length)for(const _ of e)""==s[_]&&delete s[_];window.localStorage.setItem("OT_DATA_CUSTOMER__TRACK_FB",JSON.stringify(s)),OT_DATA_CUSTOMER__TRACK_FB=s,window.localStorage.setItem("OT_DATA_CUSTOMER",JSON.stringify({em:o,ct:a,ph:n,first_name:c,last_name:t,zp:i,external_id:externalID}))}}window.omegaCallBackCheckout=function(){$.ajax({type:"GET",url:"/cart.js",dataType:"json"}).done(i=>{if(0<i.items.length){let n=[],a=[];$.each(i.items,function(t,e){if(n.push(e.variant_id),a.push(e.product_title),t==i.items.length-1){let o=generateEventID(36);arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"InitiateCheckout",{content_type:"product_group",content_ids:n,currency:Shopify.currency.active,value:parseFloat(i.total_price)/100,num_items:i.item_count,content_name:a},o)}),trackEventFBConversionAPI($,{action:"InitiateCheckout",event_id:o,event_source_url:fb_pageURL,content_ids:n,content_type:"product_group",num_items:i.item_count,value:parseFloat(i.total_price)/100,content_name:a,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}})}})};